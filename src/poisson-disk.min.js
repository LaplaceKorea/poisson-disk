!function(t,e){"function"==typeof define&&define.amd?define([],e):"object"==typeof module&&module.exports?module.exports=e():t.PoissonDisk=e()}(this,function(){"use strict";var c=0,d=0,s=0,M=0,p=1,u=30,f=Math.random,o=[],l=!0,y={width:0,height:0,cellSize:0,data:[]};function h(t,e){return isNaN(parseFloat(t))?e:parseFloat(t)}function v(){o=new Array(0),l=!0;for(var t=0;t<y.data.length;t++)y.data[t]=null}function w(t,e){var n={x:t,y:e},r=Math.floor(t/y.cellSize)+Math.floor(e/y.cellSize)*y.width;return y.data[r]=n,o.push(n),n}function S(t,e){if(t<c||d<t||e<s||M<e)return!1;var n,r,a,i,o=Math.floor((t-c)/y.cellSize),l=Math.floor((e-s)/y.cellSize),u=0,f=0,h=0;for(f=o-2;f<=o+2;f++)for(h=l-2;h<=l+2;h++)if(0<=f&&f<y.width&&0<=h&&h<y.height&&(u=f+h*y.width,null!==y.data[u]&&(n=t,r=e,a=y.data[u].x,i=y.data[u].y,(a-n)*(a-n)+(i-r)*(i-r)<=p*p)))return!1;return!0}function n(){var t=0,e=0;if(l)return l=!1,w(t=c+(d-c)*f(),e=s+(M-s)*f());for(var n=0,r=0,a=0;0<o.length;){n=o.length*f()|0;for(var i=0;i<u;i++)if(r=p*(f()+1),a=2*Math.PI*f(),S(t=o[n].x+r*Math.cos(a),e=o[n].y+r*Math.sin(a)))return w(t,e);o.splice(n,1)}return null}function PoissonDisk(t,e,n,r){var a,i,o,l;i=e,o=n,l=r,c=h((a=t)[0],0),d=h(a[1],0),s=h(a[2],0),M=h(a[3],0),p=Math.max(h(i,1),1),u=Math.max(h(o,30),2),f="function"==typeof l?l:Math.random,y.cellSize=p*Math.SQRT1_2,y.width=Math.ceil((d-c)/y.cellSize),y.height=Math.ceil((M-s)/y.cellSize),y.data=new Array(y.width*y.height),v()}return PoissonDisk.prototype={reset:function(){v()},next:function(){return n()},all:function(){return v(),function(){for(var t=null,e=new Array(0);null!=(t=n());)e.push(t);return e}()},done:function(){return!l&&0==o.length}},PoissonDisk});